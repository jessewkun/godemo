name: Release Environment CI/CD

on:
    release:
        types: [published]
    workflow_dispatch:
        inputs:
            environment:
                description: "deploy environment"
                required: true
                default: "release"
                type: choice
                options:
                    - release

permissions:
    contents: read
    packages: read

jobs:
    deploy-app-release:
        name: Deploy app to release environment
        uses: ./.github/workflows/reusable-deploy.yml
        with:
            app_name: "godemo"
            build_command: "build"
            app_type: "app"
            deploy_env: "release"
            target_path: "/root/godemo"
            notify_title: "ğŸš€ ã€godemoåç«¯ã€‘ç”Ÿäº§ç¯å¢ƒä¸Šçº¿é€šçŸ¥"
            release_json: ${{ toJson(github.event.release) }}
        secrets:
            pat_token: ${{ secrets.PAT_TOKEN }}
            remote_host: ${{ secrets.REMOTE_HOST }}
            remote_user: ${{ secrets.REMOTE_USER }}
            ssh_private_key: ${{ secrets.SSH_PRIVATE_KEY }}
            remote_port: ${{ secrets.REMOTE_PORT }}
            feishu_webhook: ${{ secrets.FEISHU_DEPLOY_ONLINE_WEBHOOK }}
